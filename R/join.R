## This file is part of the 'stringi' library.
##
## Copyright 2013 Marek Gagolewski, Bartek Tartanus
##
##
## 'stringi' is free software: you can redistribute it and/or modify
## it under the terms of the GNU Lesser General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## 'stringi' is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.See the
## GNU Lesser General Public License for more details.
##
## You should have received a copy of the GNU Lesser General Public License
## along with 'stringi'. If not, see <http://www.gnu.org/licenses/>.




#' Duplicate Strings
#'
#' Vectorized over \code{str} and \code{times}
#'
#' @param str character vector of strings to be duplicated
#' @param times integer vector with number of times to duplicate each string
#' @return character vector
#' 
#' @export
#' @family paste
#' @examples
#' stri_dup("a", 1:5)
#' stri_dup(c("a", NA, "ba"), 4)
#' stri_dup(c("abc", "pqrst"), c(4, 2))
stri_dup <- function(str, times) {
   # prepare_arg done internally
   .Call("stri_dup", str, times, PACKAGE="stringi")
}



#' Concatenate Two Character Vectors
#' 
#' Vectorized over \code{e1} and \code{e2}
#' 
#' This operator words as a call to \code{stri_join(e1, e2, sep="")}.
#' Note that, however, joining 3 vectors, e.g. \code{e1 \%+\% e2 \%+\% e3}
#' is slower than \code{stri_join(e1, e2, e3, sep="")}, 
#' because it creates a new result each time
#' 
#' @param e1 character vector
#' @param e2 character vector
#' 
#' @TODO add family `paste` (now roxygen is broken)
#' @rdname oper_plus
#' @export
"%+%" <- function(e1, e2) {
   .Call("stri_join2", e1, e2, PACKAGE="stringi")
}


#' Concatenate Character Vectors
#' 
#' 
#' 
#' @param sep single string, separates terms
#' @param collapse single string, separates the results
#' 
#' @return
#' If \code{collapse} is set to non-\code{NULL}, the the result will be a single string.
#' Otherwise, you will get a character vector of length equal
#' to the length of the longest argument.
#' 
#' If any of the arguments is a vector of length 0, then in result
#' you will get 0-length character vector.
#' 
#' In case of any \code{NA}, \code{NA} is set to the corresponding element.
#' 
#' @export
#' @family paste
#' @rdname stri_join
stri_join <- function(..., sep="", collapse=NULL) {
   .Call("stri_join", list(...), sep, collapse, PACKAGE="stringi")
}



#' @rdname stri_join
#' @export
stri_c <- stri_join

#' @rdname stri_join
#' @export
stri_paste <- stri_join


#' Flatten a String
#' 
#' 
#' 
#' Joins each element of a character vector into one string.
#' \code{stri_flatten(str, collapse='XXX')} works the same as
#' \code{paste(str, collapse='XXX', sep="")}.
#' 
#' If you wish to use some more fancy \code{collapse} separators
#' between flattened strings,
#' call \code{stri_join(str, separators, collapse='')}.
#' 
#' 
#' @param str vector of strings will be coerced to character
#' @param collapse separator, a single string
#' 
#' @return
#' If \code{str} is not empty, then a single string is returned.
#' If \code{collapse} has length > 1, then only first string
#' will be used.
#' 
#' @examples
#' stri_flatten(LETTERS)
#' stri_flatten(LETTERS, collapse=",")
#' 
#' @export
#' @family paste
stri_flatten <- function(str, collapse="") {
   # prepare_arg done internally
   .Call("stri_flatten", str, collapse, PACKAGE="stringi")
}


